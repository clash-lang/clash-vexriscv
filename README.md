<!--
SPDX-FileCopyrightText: 2023 Google LLC

SPDX-License-Identifier: Apache-2.0
-->

# VexRiscv core for Clash

This repository contains a [VexRiscv](https://github.com/SpinalHDL/VexRiscv) based CPU core and
bindings for use in [Clash](https://clash-lang.org/). The integration inserts the Verilog
generated by VexRiscv at verbatim and uses [`Verilator`](https://github.com/verilator/verilator)
to provide simulation support.

**For more information on how to use the core, see [the README in the `clash-vexriscv` package directory](clash-vexriscv/README.md).**

# Development and Contribution
We welcome contributions to this project! We use a fairly typical GitHub-based workflow for managing
contributions. You can use Nix to get a development environment using:

```bash
nix develop
```

## Continuous Integration Setup

The Continuous Integration (CI) flow for this project is defined in the `ci.yml` file. The CI has the following goals:
* Verify that the project builds successfully.
* Prevent warnings and errors in the codebase.
* Ensure functional correctness by running tests.
* Ensure code quality by running linters and formatters.

CI uses a separate cabal project file that turns warnings into errors.

### Building and Pushing the Docker Image

To build the Docker image for this project, follow these steps:

1. Navigate to the docker directory:
  ```sh
  cd .github/docker
  ```

2. Run the `build-and-publish-docker-image.sh` script:
  ```sh
  ./build-and-publish-docker-image.sh
  ```

This script builds the Docker image using the specified Ubuntu and GHC versions. It also installs the necessary dependencies and tools required for the project.

### Authentication for Pushing to GitHub

If you have an authentication token, you can use `docker login <repo_url>` to log in using your docker username and token as password.

If you don't have an authentication token, you can request the maintainers to build and push the image. Please email [devops@qbaylogic.com](mailto:devops@qbaylogic.com) with the following information:
- Repository
- Commit hash
- Branch name

## Additional Support

For other problems or questions, please refer to one of the communication channels listed on [clash-lang.org](https://clash-lang.org).
